---
title: "Analysis of longitudinal data"
date: 09 Dec 2018
output:
html_document:
theme: cerulean
---

<style type="text/css">

body{ /* Normal  */
      font-size: 12px;
  }
td {  /* Table  */
  font-size: 8px;
}
h1.title {
  font-size: 30px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 22px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 20px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
h4 { /* Header 4 */
  font-size: 14px;
  font-family: "Times New Roman", Times, serif;
  color: Black;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>


# Analysis of longitudinal data (Week 6)

### Read Data
```{r echo=F}
library("readxl")
library("ggplot2")
library("data.table")
library("dplyr")
library("stringr")
library("tidyverse")
library("GGally")
library("ggplot2")
library("MASS")
library("corrplot")
library("plotly")
library("purrr")
library("devtools")
library("ggbiplot")
library("gridExtra")
library("grid")
library("lattice")
library("FactoMineR")

rats.data <- read.table("~/Documents/GitHub/IODS-project/data/RATSL.txt", 
                    header=TRUE)
bprs.data <- read.table("~/Documents/GitHub/IODS-project/data/BPRSL.txt", 
                    header=TRUE)
```


## Chapter 8 of MABS using the RATS data

### Refactoring the variables in dataset
```{r echo=T}
rats.data$ID <- factor(rats.data$ID)
rats.data$Group <- factor(rats.data$Group)
rats.data$WD <- as.character(rats.data$WD)
glimpse(rats.data)
```

```{r echo=T}
head(rats.data)
```

#### The data comes from a nutrition study conducted in three groups of rats. The groups were put on different diets, and each animalâ€™s body weight (grams) was recorded repeatedly (approximately) weekly, except in week seven when two recordings were taken) over a 9-week period. The question of most interest is whether the growth profiles of the three groups differ.

### Plotting rat data wrt diet groups
```{r echo=T}
# Draw the plot
ggplot(rats.data, aes(x = Time, y = Weight, linetype = ID)) +
  geom_line() +
  scale_linetype_manual(values = rep(1:10, times=4)) +
  facet_grid(. ~ Group, labeller = label_both) +
  theme(legend.position = "none") + 
  scale_y_continuous(limits = c(min(rats.data$Weight), max(rats.data$Weight)))
```

#### From the above plot we see that all the rats have put up weight during the duration of study. In group 1, one rat had a lower weight compared to others when the study started. Also the slope in group 1, we see that rats in group 1 did not gain weight.

#### We see clear evidence of tracking (defined as rats who have higher weight values at the beginning tend to have higher values, in the study) for all the groups under study.

#### Taking above points, under consideration we see no change in variation between the rats.


### Standardising and plotting the data
```{r echo=T}

```



